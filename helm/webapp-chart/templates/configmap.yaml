{{- if .Values.config }}
apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ include "webapp-chart.fullname" . }}-config
  labels:
    {{- include "webapp-chart.labels" . | nindent 4 }}
    environment: {{ .Values.environment | default "development" }}
data:
  app-config.json: |
    {
      "environment": "{{ .Values.environment }}",
      "logLevel": "{{ .Values.config.logLevel }}",
      "debug": {{ .Values.config.debug }},
      "cacheEnabled": {{ .Values.config.cacheEnabled }},
      "database": {
        "host": "{{ .Values.config.database.host }}",
        "port": "{{ .Values.config.database.port }}",
        "name": "{{ .Values.config.database.name }}"
      }
    }
  application.properties: |
    app.environment={{ .Values.environment }}
    app.logLevel={{ .Values.config.logLevel }}
    app.debug={{ .Values.config.debug }}
    app.cacheEnabled={{ .Values.config.cacheEnabled }}
    db.host={{ .Values.config.database.host }}
    db.port={{ .Values.config.database.port }}
    db.name={{ .Values.config.database.name }}
{{- end }}
